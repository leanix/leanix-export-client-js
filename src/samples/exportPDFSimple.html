<html>
<head>
    <link href="../bootstrap.css" rel="stylesheet" />
    <link href="../font-awesome.css" rel="stylesheet" />

    <script src="../jquery.js"></script>
    <script src="../jquery-ui.js"></script>
    <script src="../bootstrap.js"></script>
    <script src="../lxexportclient.js"></script>
    <style>
        .simple-style {
            background-color: #d8d8d8;
            height: 200px;
        }
    </style>
</head>
<body>
<div class="row-fluid">
    <form class="form-inline">
        <input type="text" id="serverUrl" value="https://local-dev.leanix.net/services/export">
        <a href="#" class="btn btn-primary" id="export">Export</a>
        <span class="status"></span>
        <div id="result"></div>
    </form>
</div>


<div id="exportTarget">
    <div class="simple-style">
        Hello World
    </div>
</div>

<script>
    $(document).ready(function()
    {
        // Default data
        var data = new ExportData();
        data.setOutputType('PDF');
        data.getPaperSize().setFormat('A4');
        data.getPaperSize().setOrientation('portrait');
        data.getPaperSize().getHeader().setHeight('0.8in');
        data.getPaperSize().getHeader().setContents('<h1>Header Text</h1>');
        data.getPaperSize().getFooter().setHeight('0.2in');
        data.getPaperSize().getFooter().setContents('<div>Footer</div>');

        // Initialize export client
        $('#export').exportclient({
            serverUrl: $('#serverUrl').val(),
            defaultData : data
        });

        // React on the button event
        $(document).on("click", "#export", function(event)
        {
            $('.status').html('Exporting ...');
            $('#export').data('lx-exportclient').export(function (result)
            {
                $('.status').html('Done');
                var download = $('<a></a>').attr('href', $('#serverUrl').val() + '/' + result.data.relativeUrl).html('Download').addClass('btn btn-primary');

                $('#result').html(download);
            });
        });

        $('#export').data('lx-exportclient').onGetData(function(data)
        {
            data.setData($('#exportTarget').html());
            data.extractStyles();
            return data;
        });

    });
</script>

</body>
</html>